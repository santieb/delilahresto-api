
const listProducts = document.getElementById('listProducts')
const section = document.getElementById('section').content
const fragment = document.createDocumentFragment()

document.addEventListener('DOMContentLoaded', () => {
  fetchProducts()
})

const fetchProducts = async () => {
  try {
    const res = await fetch("http://localhost:3000/products")
    const data = await res.json()
    renderProducts(data)
  }
  catch (err) {
    console.log(err)
  }
}

const renderProducts = (data) => {
  data.forEach((product) => {
    section.querySelector('h4').textContent = product.name
    section.querySelector('h9').textContent = product.abbreviation
    section.querySelector('p').textContent = product.price
    section.querySelector('img').setAttribute('src', 'data:image/jpeg;base64,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')

    const clone = section.cloneNode(true)
    fragment.appendChild(clone)
  })
  listProducts.appendChild(fragment)
}


const order = []

document.addEventListener('click', e => {
  addCart(e)
})

const addCart= e => {
  if(e.target.classList.contains('add-to-cart')) {
    const product = e.target.parentElement
    const productName = product.querySelector('h4').textContent

    if (order.every(order => order.product !== productName)) {
      order.push({product: productName})

      order.forEach(item => {
        if(item.amount === undefined) item.amount = 1
      })
    }
  
    else alert('El producto ya est√° en el carrito')
    console.log(order)
    document.getElementById('cart').innerHTML = order
  }
  e.stopPropagation()
}

